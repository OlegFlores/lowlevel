# No libc example 1. Own _start symbol

## Compile and run
```shell
$ make
$ make run
```
Compiled file is is stored in `./nolibc1`

## See disassembled code

```shell
$ objdump -d ./nolibc1

./nolibc1:     file format elf64-x86-64
architecture: i386:x86-64, flags 0x00000102:
EXEC_P, D_PAGED
start address 0x00000000004000ef


Disassembly of section .text:

00000000004000b0 <.text>:
  4000b0:	f3 0f 1e fa          	endbr64 
  4000b4:	50                   	push   %rax
  4000b5:	ba 06 00 00 00       	mov    $0x6,%edx
  4000ba:	bf 01 00 00 00       	mov    $0x1,%edi
  4000bf:	48 8d 35 5b 00 00 00 	lea    0x5b(%rip),%rsi        # 0x400121
  4000c6:	e8 04 00 00 00       	callq  0x4000cf
  4000cb:	31 c0                	xor    %eax,%eax
  4000cd:	5a                   	pop    %rdx
  4000ce:	c3                   	retq   
  4000cf:	f3 0f 1e fa          	endbr64 
  4000d3:	49 89 f2             	mov    %rsi,%r10
  4000d6:	48 89 d1             	mov    %rdx,%rcx
  4000d9:	48 63 f7             	movslq %edi,%rsi
  4000dc:	45 31 c9             	xor    %r9d,%r9d
  4000df:	45 31 c0             	xor    %r8d,%r8d
  4000e2:	4c 89 d2             	mov    %r10,%rdx
  4000e5:	bf 01 00 00 00       	mov    $0x1,%edi
  4000ea:	e9 1d 00 00 00       	jmpq   0x40010c
  4000ef:	48 31 ed             	xor    %rbp,%rbp
  4000f2:	5f                   	pop    %rdi
  4000f3:	48 89 e6             	mov    %rsp,%rsi
  4000f6:	48 83 e4 f0          	and    $0xfffffffffffffff0,%rsp
  4000fa:	e8 b1 ff ff ff       	callq  0x4000b0
  4000ff:	48 89 c7             	mov    %rax,%rdi
  400102:	48 c7 c0 3c 00 00 00 	mov    $0x3c,%rax
  400109:	0f 05                	syscall 
  40010b:	c3                   	retq   
  40010c:	48 89 f8             	mov    %rdi,%rax
  40010f:	48 89 f7             	mov    %rsi,%rdi
  400112:	48 89 d6             	mov    %rdx,%rsi
  400115:	48 89 ca             	mov    %rcx,%rdx
  400118:	4d 89 c2             	mov    %r8,%r10
  40011b:	4d 89 c8             	mov    %r9,%r8
  40011e:	0f 05                	syscall 
  400120:	c3                   	retq  
```

## See file sections

```shell
$ objdump -x ./nolibc1

./nolibc1:     file format elf64-x86-64
./nolibc1
architecture: i386:x86-64, flags 0x00000102:
EXEC_P, D_PAGED
start address 0x00000000004000ef

Program Header:
    LOAD off    0x00000000000000b0 vaddr 0x00000000004000b0 paddr 0x00000000004000b0 align 2**0
         filesz 0x0000000000000078 memsz 0x0000000000000078 flags r-x
   STACK off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**4
         filesz 0x0000000000000000 memsz 0x0000000000000000 flags rwx

Sections:
Idx Name          Size      VMA               LMA               File off  Algn
  0 .text         00000071  00000000004000b0  00000000004000b0  000000b0  2**0
                  CONTENTS, ALLOC, LOAD, READONLY, CODE
  1 .rodata       00000007  0000000000400121  0000000000400121  00000121  2**0
                  CONTENTS, ALLOC, LOAD, READONLY, DATA
  2 .comment      0000002b  0000000000000000  0000000000000000  00000128  2**0
                  CONTENTS, READONLY
SYMBOL TABLE:
no symbols
```
- .text is our compiled executable code 
- .rodata contains string constant used as argument of write function
- .comment is a text added by compiler

## See file section content

```shell
objdump -s -j .text -j .comment -j .rodata ./nolibc1

./nolibc1:     file format elf64-x86-64

Contents of section .text:
 4000b0 f30f1efa 50ba0600 0000bf01 00000048  ....P..........H
 4000c0 8d355b00 0000e804 00000031 c05ac3f3  .5[........1.Z..
 4000d0 0f1efa49 89f24889 d14863f7 4531c945  ...I..H..Hc.E1.E
 4000e0 31c04c89 d2bf0100 0000e91d 00000048  1.L............H
 4000f0 31ed5f48 89e64883 e4f0e8b1 ffffff48  1._H..H........H
 400100 89c748c7 c03c0000 000f05c3 4889f848  ..H..<......H..H
 400110 89f74889 d64889ca 4d89c24d 89c80f05  ..H..H..M..M....
 400120 c3                                   .               
Contents of section .rodata:
 400121 68656c6c 6f0a00                      hello..         
Contents of section .comment:
 0000 4743433a 20285562 756e7475 20392e34  GCC: (Ubuntu 9.4
 0010 2e302d31 7562756e 7475317e 32302e30  .0-1ubuntu1~20.0
 0020 342e3129 20392e34 2e3000             4.1) 9.4.0.
```

## Display hex content of the file

```shell
$ xxd ./nolibc1
00000000: 7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF............
00000010: 0200 3e00 0100 0000 ef00 4000 0000 0000  ..>.......@.....
00000020: 4000 0000 0000 0000 7801 0000 0000 0000  @.......x.......
00000030: 0000 0000 4000 3800 0200 4000 0500 0400  ....@.8...@.....
00000040: 0100 0000 0500 0000 b000 0000 0000 0000  ................
00000050: b000 4000 0000 0000 b000 4000 0000 0000  ..@.......@.....
00000060: 7800 0000 0000 0000 7800 0000 0000 0000  x.......x.......
00000070: 0100 0000 0000 0000 51e5 7464 0700 0000  ........Q.td....
00000080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000000a0: 0000 0000 0000 0000 1000 0000 0000 0000  ................
000000b0: f30f 1efa 50ba 0600 0000 bf01 0000 0048  ....P..........H
000000c0: 8d35 5b00 0000 e804 0000 0031 c05a c3f3  .5[........1.Z..
000000d0: 0f1e fa49 89f2 4889 d148 63f7 4531 c945  ...I..H..Hc.E1.E
000000e0: 31c0 4c89 d2bf 0100 0000 e91d 0000 0048  1.L............H
000000f0: 31ed 5f48 89e6 4883 e4f0 e8b1 ffff ff48  1._H..H........H
00000100: 89c7 48c7 c03c 0000 000f 05c3 4889 f848  ..H..<......H..H
00000110: 89f7 4889 d648 89ca 4d89 c24d 89c8 0f05  ..H..H..M..M....
00000120: c368 656c 6c6f 0a00 4743 433a 2028 5562  .hello..GCC: (Ub
00000130: 756e 7475 2039 2e34 2e30 2d31 7562 756e  untu 9.4.0-1ubun
00000140: 7475 317e 3230 2e30 342e 3129 2039 2e34  tu1~20.04.1) 9.4
00000150: 2e30 0000 2e73 6873 7472 7461 6200 2e74  .0...shstrtab..t
00000160: 6578 7400 2e72 6f64 6174 6100 2e63 6f6d  ext..rodata..com
00000170: 6d65 6e74 0000 0000 0000 0000 0000 0000  ment............
00000180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000001b0: 0000 0000 0000 0000 0b00 0000 0100 0000  ................
000001c0: 0600 0000 0000 0000 b000 4000 0000 0000  ..........@.....
000001d0: b000 0000 0000 0000 7100 0000 0000 0000  ........q.......
000001e0: 0000 0000 0000 0000 0100 0000 0000 0000  ................
000001f0: 0000 0000 0000 0000 1100 0000 0100 0000  ................
00000200: 3200 0000 0000 0000 2101 4000 0000 0000  2.......!.@.....
00000210: 2101 0000 0000 0000 0700 0000 0000 0000  !...............
00000220: 0000 0000 0000 0000 0100 0000 0000 0000  ................
00000230: 0100 0000 0000 0000 1900 0000 0100 0000  ................
00000240: 3000 0000 0000 0000 0000 0000 0000 0000  0...............
00000250: 2801 0000 0000 0000 2b00 0000 0000 0000  (.......+.......
00000260: 0000 0000 0000 0000 0100 0000 0000 0000  ................
00000270: 0100 0000 0000 0000 0100 0000 0300 0000  ................
00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000290: 5301 0000 0000 0000 2200 0000 0000 0000  S.......".......
000002a0: 0000 0000 0000 0000 0100 0000 0000 0000  ................
000002b0: 0000 0000 0000 0000                      ........

```

## Remove a section from file

```shell
$ ls -al ./nolibc1
-rwxrwxr-x 1 user user 696 jul 16 01:30 ./nolibc1

$ objcopy --remove-section .comment ./nolibc1

$ xxd ./nolibc1
00000000: 7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF............
00000010: 0200 3e00 0100 0000 ef00 4000 0000 0000  ..>.......@.....
00000020: 4000 0000 0000 0000 4801 0000 0000 0000  @.......H.......
00000030: 0000 0000 4000 3800 0200 4000 0400 0300  ....@.8...@.....
00000040: 0100 0000 0500 0000 b000 0000 0000 0000  ................
00000050: b000 4000 0000 0000 b000 4000 0000 0000  ..@.......@.....
00000060: 7800 0000 0000 0000 7800 0000 0000 0000  x.......x.......
00000070: 0100 0000 0000 0000 51e5 7464 0700 0000  ........Q.td....
00000080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
000000a0: 0000 0000 0000 0000 1000 0000 0000 0000  ................
000000b0: f30f 1efa 50ba 0600 0000 bf01 0000 0048  ....P..........H
000000c0: 8d35 5b00 0000 e804 0000 0031 c05a c3f3  .5[........1.Z..
000000d0: 0f1e fa49 89f2 4889 d148 63f7 4531 c945  ...I..H..Hc.E1.E
000000e0: 31c0 4c89 d2bf 0100 0000 e91d 0000 0048  1.L............H
000000f0: 31ed 5f48 89e6 4883 e4f0 e8b1 ffff ff48  1._H..H........H
00000100: 89c7 48c7 c03c 0000 000f 05c3 4889 f848  ..H..<......H..H
00000110: 89f7 4889 d648 89ca 4d89 c24d 89c8 0f05  ..H..H..M..M....
00000120: c368 656c 6c6f 0a00 002e 7368 7374 7274  .hello....shstrt
00000130: 6162 002e 7465 7874 002e 726f 6461 7461  ab..text..rodata
00000140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000180: 0000 0000 0000 0000 0b00 0000 0100 0000  ................
00000190: 0600 0000 0000 0000 b000 4000 0000 0000  ..........@.....
000001a0: b000 0000 0000 0000 7100 0000 0000 0000  ........q.......
000001b0: 0000 0000 0000 0000 0100 0000 0000 0000  ................
000001c0: 0000 0000 0000 0000 1100 0000 0100 0000  ................
000001d0: 3200 0000 0000 0000 2101 4000 0000 0000  2.......!.@.....
000001e0: 2101 0000 0000 0000 0700 0000 0000 0000  !...............
000001f0: 0000 0000 0000 0000 0100 0000 0000 0000  ................
00000200: 0100 0000 0000 0000 0100 0000 0300 0000  ................
00000210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000220: 2801 0000 0000 0000 1900 0000 0000 0000  (...............
00000230: 0000 0000 0000 0000 0100 0000 0000 0000  ................
00000240: 0000 0000 0000 0000                      ........
```

## Analyze file sections size

```shell
$ size -A -d ./nolibc1 
./nolibc1  :
section   size      addr
.text      113   4194480
.rodata      7   4194593
Total      120

```